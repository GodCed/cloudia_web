\href{https://npmjs.org/package/raw-body}{\tt !\mbox{[}N\+P\+M Version\mbox{]}\mbox{[}npm-\/image\mbox{]}} \href{https://npmjs.org/package/raw-body}{\tt !\mbox{[}N\+P\+M Downloads\mbox{]}\mbox{[}downloads-\/image\mbox{]}} \href{https://travis-ci.org/stream-utils/raw-body}{\tt !\mbox{[}Build status\mbox{]}\mbox{[}travis-\/image\mbox{]}} \href{https://coveralls.io/r/stream-utils/raw-body?branch=master}{\tt !\mbox{[}Test coverage\mbox{]}\mbox{[}coveralls-\/image\mbox{]}}

Gets the entire buffer of a stream either as a {\ttfamily Buffer} or a string. Validates the stream\textquotesingle{}s length against an expected length and maximum limit. Ideal for parsing request bodies.

\subsection*{A\+P\+I}


\begin{DoxyCode}
\hyperlink{018__def_8c_a335628f2e9085305224b4f9cc6e95ed5}{var} getRawBody = require(\textcolor{stringliteral}{'raw-body'})
\hyperlink{018__def_8c_a335628f2e9085305224b4f9cc6e95ed5}{var} typer      = require('media-typer')

app.use(\hyperlink{class_test_a51a683fa4fcec142ab1574e00a7b6860}{function} (req, res, next) \{
  getRawBody(req, \{
    length: req.headers[\textcolor{stringliteral}{'content-length'}],
    limit: \textcolor{stringliteral}{'1mb'},
    encoding: typer.parse(req.headers[\textcolor{stringliteral}{'content-type'}]).parameters.charset
  \}, \textcolor{keyword}{function} (\hyperlink{message_8cpp_aede5746344fdce99647541101eaa7f06}{err}, \hyperlink{tclscanner_8cpp_a3b18665bed369c4cf583afc1b05f583a}{string}) \{
    \textcolor{keywordflow}{if} (\hyperlink{message_8cpp_aede5746344fdce99647541101eaa7f06}{err})
      \textcolor{keywordflow}{return} \hyperlink{057__caller__graphs_8tcl_a3f808a00e1b937978455d707851ab33a}{next}(\hyperlink{message_8cpp_aede5746344fdce99647541101eaa7f06}{err})

    req.text = \textcolor{keywordtype}{string}
    next()
  \})
\})
\end{DoxyCode}


or in a Koa generator\+:


\begin{DoxyCode}
app.use(\textcolor{keyword}{function}* (next) \{
  \hyperlink{018__def_8c_a335628f2e9085305224b4f9cc6e95ed5}{var} \textcolor{keywordtype}{string} = yield getRawBody(this.req, \{
    length: this.length,
    limit: \textcolor{stringliteral}{'1mb'},
    encoding: this.charset
  \})
\})
\end{DoxyCode}


\subsubsection*{get\+Raw\+Body(stream, \mbox{[}options\mbox{]}, \mbox{[}callback\mbox{]})}

Returns a thunk for yielding with generators.

Options\+:


\begin{DoxyItemize}
\item {\ttfamily length} -\/ The length length of the stream. If the contents of the stream do not add up to this length, an {\ttfamily 400} error code is returned.
\item {\ttfamily limit} -\/ The byte limit of the body. If the body ends up being larger than this limit, a {\ttfamily 413} error code is returned.
\item {\ttfamily encoding} -\/ The requested encoding. By default, a {\ttfamily Buffer} instance will be returned. Most likely, you want {\ttfamily utf8}. You can use any type of encoding supported by \href{https://www.npmjs.org/package/iconv-lite#readme}{\tt iconv-\/lite}.
\end{DoxyItemize}

You can also pass a string in place of options to just specify the encoding.

{\ttfamily callback(err, res)}\+:


\begin{DoxyItemize}
\item {\ttfamily err} -\/ the following attributes will be defined if applicable\+:
\begin{DoxyItemize}
\item {\ttfamily limit} -\/ the limit in bytes
\item {\ttfamily length} and {\ttfamily expected} -\/ the expected length of the stream
\item {\ttfamily received} -\/ the received bytes
\item {\ttfamily encoding} -\/ the invalid encoding
\item {\ttfamily status} and {\ttfamily status\+Code} -\/ the corresponding status code for the error
\item {\ttfamily type} -\/ either {\ttfamily entity.\+too.\+large}, {\ttfamily request.\+aborted}, {\ttfamily request.\+size.\+invalid}, {\ttfamily stream.\+encoding.\+set}, or {\ttfamily encoding.\+unsupported}
\end{DoxyItemize}
\item {\ttfamily res} -\/ the result, either as a {\ttfamily \hyperlink{class_string}{String}} if an encoding was set or a {\ttfamily Buffer} otherwise.
\end{DoxyItemize}

If an error occurs, the stream will be paused, everything unpiped, and you are responsible for correctly disposing the stream. For H\+T\+T\+P requests, no handling is required if you send a response. For streams that use file descriptors, you should {\ttfamily stream.\+destroy()} or {\ttfamily stream.\+close()} to prevent leaks.

\subsection*{License}

\mbox{[}M\+I\+T\mbox{]}(L\+I\+C\+E\+N\+S\+E) 